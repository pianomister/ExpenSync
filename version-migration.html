<html>
  <head></head>
  <body>
    <h1>Migration</h1>
    <p>
      [{item}, {item}]
    </p>
    <textarea id="text-in"></textarea>
    <button id="button-migrate">Migrate</button>
    <textarea id="text-out"></textarea>

    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/md5.js"></script>

    <script type="text/javascript">

    function createUniqueid(timestamp, salt, noUserAgent) {

      noUserAgent = noUserAgent || false;

      var str = '' + timestamp + salt;
      if(!noUserAgent)
        str += navigator.userAgent;

      return calcMD5( str );
    }


    // categories
    var _categories = ["Other", "Groceries", "Canteen", "Eating Out", "Fun", "Clothing", "Car", "Transport", "Travel", "Household", "Salary", "Finance", "Medical", "Education", "Rent / Loan", "Communication"];
    _cats  = {};
    accountID = createUniqueid(1, 'Default', true);

    for(var k = 0; k < _categories.length; k++) {

      _cats[k+1] = createUniqueid( k, k, true );
    }

    // migrate button
    $('#button-migrate').click( function() {

      var input = JSON.parse($('#text-in').val());

      console.log(input);

      for(var i = 0; i < input.length; i++) {

        input[i].category = _cats[ input[i].category ];
        input[i].synchronized = true;
        input[i].account = accountID;
        input[i].version = '0.2';
      }

    $('#text-out').val( JSON.stringify(input) );

    });

    </script>
  </body>
</html>
